<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringSecurity基本原理 | 若你困于无风之地</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="心怀不惧，方能无畏">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.a6c2c17f.css" as="style"><link rel="preload" href="/assets/js/app.3ca46f51.js" as="script"><link rel="preload" href="/assets/js/4.296817db.js" as="script"><link rel="preload" href="/assets/js/1.e29b6016.js" as="script"><link rel="preload" href="/assets/js/9.32223661.js" as="script"><link rel="preload" href="/assets/js/14.e948865e.js" as="script"><link rel="prefetch" href="/assets/js/10.ad8d37b6.js"><link rel="prefetch" href="/assets/js/11.aa15adf2.js"><link rel="prefetch" href="/assets/js/12.56d827a3.js"><link rel="prefetch" href="/assets/js/13.6563b377.js"><link rel="prefetch" href="/assets/js/15.d3c28d03.js"><link rel="prefetch" href="/assets/js/16.a405dc67.js"><link rel="prefetch" href="/assets/js/17.a5fb15ad.js"><link rel="prefetch" href="/assets/js/18.6732da60.js"><link rel="prefetch" href="/assets/js/19.0097e4e7.js"><link rel="prefetch" href="/assets/js/20.f4aad30c.js"><link rel="prefetch" href="/assets/js/21.b7ae5c1c.js"><link rel="prefetch" href="/assets/js/22.f7c33985.js"><link rel="prefetch" href="/assets/js/23.7be09bc9.js"><link rel="prefetch" href="/assets/js/24.66192fdc.js"><link rel="prefetch" href="/assets/js/25.fc163990.js"><link rel="prefetch" href="/assets/js/26.c13baebd.js"><link rel="prefetch" href="/assets/js/27.1efc4755.js"><link rel="prefetch" href="/assets/js/28.0a845ad0.js"><link rel="prefetch" href="/assets/js/29.a54cd901.js"><link rel="prefetch" href="/assets/js/3.850642ab.js"><link rel="prefetch" href="/assets/js/30.7248d99f.js"><link rel="prefetch" href="/assets/js/31.30c3af6b.js"><link rel="prefetch" href="/assets/js/32.f167b765.js"><link rel="prefetch" href="/assets/js/33.f0e3194f.js"><link rel="prefetch" href="/assets/js/5.a4580fb2.js"><link rel="prefetch" href="/assets/js/6.2c804fd7.js"><link rel="prefetch" href="/assets/js/7.ee42d5d4.js"><link rel="prefetch" href="/assets/js/8.b3de8252.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a6c2c17f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>若你困于无风之地</h3> <p class="description" data-v-59e6cb88>心怀不惧，方能无畏</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>是秃子总会发光</span>
          
        <span data-v-59e6cb88>2023 - </span>
        2024
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="若你困于无风之地" class="logo"> <span class="site-name">若你困于无风之地</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/categories/安全框架/" class="nav-link"><i class="undefined"></i>
  安全框架
</a></li><li class="dropdown-item"><!----> <a href="/categories/博客/" class="nav-link"><i class="undefined"></i>
  博客
</a></li><li class="dropdown-item"><!----> <a href="/categories/多线程/" class="nav-link"><i class="undefined"></i>
  多线程
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="https://github.com/SimpleWordBlog" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    是秃子总会发光
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>21</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>5</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/categories/安全框架/" class="nav-link"><i class="undefined"></i>
  安全框架
</a></li><li class="dropdown-item"><!----> <a href="/categories/博客/" class="nav-link"><i class="undefined"></i>
  博客
</a></li><li class="dropdown-item"><!----> <a href="/categories/多线程/" class="nav-link"><i class="undefined"></i>
  多线程
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="https://github.com/SimpleWordBlog" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MySql</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Shiro</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>SpringSecurity</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/" aria-current="page" class="active sidebar-link">SpringSecurity基本原理</a></li><li><a href="/docs/SpringSecurity-2-%E5%87%86%E5%A4%87/" class="sidebar-link">SpringSecurity环境准备</a></li><li><a href="/docs/SpringSecurity-3-JWT-redis/" class="sidebar-link">SpringSecurity-Jwt-redis</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ThreadLocal</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>VuePress</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>SpringSecurity基本原理</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>是秃子总会发光</span>
          
        <span data-v-59e6cb88>2023 - </span>
        2024
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">SpringSecurity基本原理</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>是秃子总会发光</span></i> <!----> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>SpringSecurity</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="入门程序"><a href="#入门程序" class="header-anchor">#</a> 入门程序</h2> <h3 id="准备"><a href="#准备" class="header-anchor">#</a> 准备</h3> <p><code>maven</code></p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>controller</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> userController <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">helloSpringSecurity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hello SpringSecurity&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>yml</code></p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">security</span><span class="token punctuation">:</span>
    <span class="token key atrule">user</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> zwh
      <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="结果"><a href="#结果" class="header-anchor">#</a> 结果</h3> <p><img src="data:image/png;base64,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" alt="image-20231114155652128"></p> <div class="custom-block tip"><p class="title"></p><ul><li>引入<strong>SpringSecurity</strong>后，每次访问前需要认证，输入用户和密码，认证后当前可以访问任意资源</li> <li>此案例中用户和密码在yml中配置【这种方式只能配置一个用户】，不配置会在控制台生成密码，用户名默认是user</li></ul></div><h2 id="基本原理"><a href="#基本原理" class="header-anchor">#</a> 基本原理</h2> <p>SpringSecurity本质是<strong>过滤器链</strong>【Filter chains】，由多个过滤器组成，放行后进入下一个过滤器。</p> <h3 id="securityconfigureradapter"><a href="#securityconfigureradapter" class="header-anchor">#</a> <strong>SecurityConfigurerAdapter：</strong></h3> <p>​	过滤器链中的每个过滤器都由<code>SecurityConfigurerAdapter</code>实现。这些配置适配器负责定义过滤器的行为，包括身份验证管理、访问控制规则等。</p> <h3 id="filter-chain的执行"><a href="#filter-chain的执行" class="header-anchor">#</a> <strong>Filter Chain的执行：</strong></h3> <p>​	当客户端发送请求时，该请求将被传递给过滤器链。过滤器链按照配置的顺序逐个执行，每个过滤器都有机会对请求进行处理。</p> <p><strong>SecurityContextHolder：</strong></p> <p>​	 过滤器链中的过滤器可以访问<code>SecurityContextHolder</code>，它存储了与当前线程关联的安全上下文。安全上下文包含了用户的身份信息和相应的权限。</p> <h2 id="认证"><a href="#认证" class="header-anchor">#</a> 认证</h2> <h3 id="认证流程"><a href="#认证流程" class="header-anchor">#</a> 认证流程</h3> <p><img src="/assets/img/035.afa574bf.png" alt="image-20231125180631282"></p> <div class="custom-block tip"><p class="title"></p><ul><li><p>输入用户名和密码，提交</p></li> <li><p>把提交用户名和密码封装对象(Authenticatio)</p></li> <li><p>调用方法实现认证-&gt;调用方法，根据用户名查询用户信息</p></li> <li><p>查询用户信息返回用户对象(UserDetails)</p></li> <li><p>密码比较(Password、UserDetails、Authenticatio)</p></li> <li><p>填充回对象(Authenticatio)</p></li> <li><p>返回对象(Authenticatio)放到上下文对象里面(SecurityContex)</p></li></ul></div><h3 id="认证核心组件【必看】"><a href="#认证核心组件【必看】" class="header-anchor">#</a> 认证核心组件【必看】</h3> <ul><li><p><strong><code>Authentication</code></strong>，它存储了认证信息，代表当前登录用户。</p> <ul><li><code>Principal</code>：用户信息，没有认证时一般是用户名，认证后一般是用户对象</li> <li><code>Credentials</code>：用户凭证，一般是密码</li> <li><code>Authorities</code>：用户权限</li></ul></li> <li><p>最终存储在 <strong><code>SecurityContext</code></strong> ，可以通过它来获取`Authentication``</p> <ul><li><code>SecurityContext</code>就是我们的上下文对象，可以在任何时期使用。(参考servletContext)</li></ul></li> <li><p><code>SecurityContextHolder</code>管理上下文对象，可以通过它来获取上下文对象</p></li></ul> <h3 id="用户认证过程源码【必看】"><a href="#用户认证过程源码【必看】" class="header-anchor">#</a> 用户认证过程源码【必看】</h3> <p>代码结合此图查看</p> <p><img src="/assets/img/036.afa574bf.png" alt="image-20231125194339304"></p> <p>IDEA查看<code>UsernamePasswordAuthenticationFilter</code>。</p> <ul><li><p>登录过滤器，用户名和密码的校验</p></li> <li><p>其中方法【<code>子类可重写</code>】</p></li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Authentication</span> <span class="token function">attemptAuthentication</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AuthenticationException</span><span class="token punctuation">{</span>
  
 	<span class="token comment">//	1.在此方法中，我们可以从request获取请求方式、用户名和密码【可能输入为null,获取不到，try...catch或判断null】</span>
  <span class="token comment">//	2.可以单独获取用户名和密码[这种方式需要保证用户名是username,密码是password](默认方式)</span>
  		<span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token function">obtainUsername</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token function">obtainPassword</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//  3.也可以使用流的方式，可以封装为对象,这里loginVo自定义的</span>
  		<span class="token class-name">LoginVo</span> loginVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">LoginVo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//  4.将用户信息封装到UsernamePasswordAuthenticationToken，这里可以使用多态</span>
  		 <span class="token class-name">Authentication</span> authenticationToken <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//  5.返回给此过滤器</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAuthenticationManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span>authRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="custom-block tip"><p class="title"></p><p>这里我们提到了<code>UsernamePasswordAuthenticationFilter</code>、<code>Authentication</code>、<code>UsernamePasswordAuthenticationToken</code></p></div><p>第5步说明</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/*
authenticate()负责认证,此方法在AuthenticationManager中
getAuthenticationManager()就是得到AuthenticationManager
*/</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAuthenticationManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span>authRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
AuthenticationManager的authenticat()的有一个实现类ProviderManager
ProviderManager中又委托AuthenticationProvider的authenticat()完成认证
*/</span>
result <span class="token operator">=</span> provider<span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span>authentication<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
AuthenticationProvider的authenticat()由一个(抽象)实现类
AbstractUserDetailsAuthenticationProvider。
该抽象类又有一个实现类 DaoAuthenticationProvider
根据条件其中会调用UserDetailsService的唯一方法loadUserByUsername()来校验用户是否有效
此后通过加密机校验密码
*/</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUserDetailsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//完成认证后回填，返回的还是Authentication，即用户对象</span>
<span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">createSuccessAuthentication</span><span class="token punctuation">(</span>principal<span class="token punctuation">,</span> authentication<span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
最后在UsernamePasswordAuthenticationFilter的父类abstractAuthenticationProcessingFilter
中还有两个重要方法认证成功和认证失败
*/</span>
<span class="token keyword">void</span> <span class="token function">successfulAuthentication</span><span class="token punctuation">(</span>参数<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>，authResult<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//成功后会将用户对象存储在Security上下文</span>
  <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">unsuccessfulAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="认证核心"><a href="#认证核心" class="header-anchor">#</a> 认证核心</h3> <p><code>AuthenticationManager</code></p> <div class="custom-block tip"><p class="title"></p><ul><li><p>根据用户名先查询出用户对象(没有查到则抛出异常)</p> <ul><li>此步调用的是<code>UserDetialsService</code>的loadUserByUsername(String username)方法</li> <li>返回对象<code>UserDetails</code></li></ul></li> <li><p>将用户对象的密码和传递过来的密码进行校验，密码不匹配则抛出异常。</p> <ul><li>密码校验Springsecurity提供了<code>PasswordEncoder</code></li></ul></li></ul></div><p>认证过程大致如下</p> <ul><li>校验用户是否存在<code>loadUserByUsername(username)</code></li> <li>校验密码:<code>passwordEncoder</code></li> <li>认证成功回填</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Authentication</span> <span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token class-name">Authentication</span> authentication<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AuthenticationException</span> <span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>省略其他代码

    <span class="token comment">// 传递过来的用户名</span>
    <span class="token class-name">String</span> username <span class="token operator">=</span> authentication<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 调用UserDetailService的方法，通过用户名查询出用户对象UserDetail（查询不出来UserDetailService则会抛出异常）</span>
    <span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUserDetailsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadUserByUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> presentedPassword <span class="token operator">=</span> authentication<span class="token punctuation">.</span><span class="token function">getCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 传递过来的密码</span>
    <span class="token class-name">String</span> password <span class="token operator">=</span> authentication<span class="token punctuation">.</span><span class="token function">getCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 使用密码解析器PasswordEncoder传递过来的密码是否和真实的用户密码匹配</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>passwordEncoder<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> userDetails<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 密码错误则抛出异常</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BadCredentialsException</span><span class="token punctuation">(</span><span class="token string">&quot;错误信息...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 注意哦，这里返回的已认证Authentication，是将整个UserDetails放进去充当Principal</span>
    <span class="token class-name">UsernamePasswordAuthenticationToken</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">,</span>
            authentication<span class="token punctuation">.</span><span class="token function">getCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> userDetails<span class="token punctuation">.</span><span class="token function">getAuthorities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>省略其他代码
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="custom-block warning"><p class="title">注意</p><p><code>UserDetialsService</code>、<code>UserDetails</code>、<code>PasswordEncoder</code>，这三个组件Spring Security都有默认实现</p> <p>这一般是满足不了我们的实际需求的，所以我们自己来实现这些组件！</p></div><h2 id="认证方式"><a href="#认证方式" class="header-anchor">#</a> 认证方式</h2> <div class="custom-block tip"><p class="title">提示</p><p>下面使用的都是<code>默认的认证方法</code>（attemptAuthentication）（ authenticate）</p></div><h3 id="通过配置文件"><a href="#通过配置文件" class="header-anchor">#</a> 通过配置文件</h3> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">security</span><span class="token punctuation">:</span>
    <span class="token key atrule">user</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> zwh
      <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="基于内存"><a href="#基于内存" class="header-anchor">#</a> 基于内存</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token comment">/*
1.通过继承WebSecurityConfigurerAdapter类，可以覆盖其中的方法来配置Spring Security的行为
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">/*
          1.在内存中获取,配置用户名、密码和角色
          2.SPS要求密码需要使用密文，可以使用它提供的加密机【有多种】或者自定义加密机
         */</span>
        <span class="token class-name">BCryptPasswordEncoder</span> pe <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        auth<span class="token punctuation">.</span><span class="token function">inMemoryAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withUser</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span>pe<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">PasswordEncoder</span> <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><div class="custom-block warning"><p class="title"></p><p>这两种方式都不常用【适用于只有少量管理员的场景】，实际开发中都是在数据库查询用户密码</p></div><h3 id="基于数据库【重要】"><a href="#基于数据库【重要】" class="header-anchor">#</a> 基于数据库【重要】</h3> <p>如果在内存找不到，就会使用<code>UserDetailsService</code>它的<code>loadUserByUsername(name)</code></p> <p>即用户认证信息不再从内存查找，通过数据库查询，我们自定义实现类即可，交由Spring管理。</p> <ul><li>第一步<strong>创建配置类</strong>,设置使用哪个userDetailsService实现类</li> <li>第二步<strong>编写实现类</strong>，返回User对象，User对象有用户名密码和操作权限</li></ul> <p><code>配置类</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig2</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserDetailsService</span> uds<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">/*
          1.userDetailsService获取用户信息，常用于从数据库获取
          2.passwordEncoder设置密码编码器
         */</span>
        auth<span class="token punctuation">.</span><span class="token function">userDetailsService</span><span class="token punctuation">(</span>uds<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">PasswordEncoder</span> <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><code>实现类</code></p> <div class="custom-block warning"><p class="title"></p><ul><li>这里最终返回UserDetails对象，可以返回Security提供的User对象，也可以自定义User对象【自带的属性于数据库中不同】</li> <li>这里查询数据库用户是否存在，用户是否启用、用户权限等，总之于User对象相关的属性，最后返回User对象</li></ul></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//需要注入到配置类，标记为Spring Bean</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpsBean</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token comment">/*
         1.在这里我们可以查询数据库获取用户信息、权限等,当前先不使用
         2.当前下方的User对象由Sps提供的，是返回的结果类型
         */</span>
        <span class="token comment">//需要加密，数据库也应该存储加密后的密码，加密算法一个相同</span>
        <span class="token class-name">BCryptPasswordEncoder</span> pe <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//权限集合【找不到的角色【如这里的role】则可以访问所有资源】，这里取决于User对象是否需要</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GrantedAuthority</span><span class="token punctuation">&gt;</span></span> authorities <span class="token operator">=</span> <span class="token class-name">AuthorityUtils</span><span class="token punctuation">.</span><span class="token function">commaSeparatedStringToAuthorityList</span><span class="token punctuation">(</span><span class="token string">&quot;role&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">&quot;li&quot;</span><span class="token punctuation">,</span> pe<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> authorities<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="授权"><a href="#授权" class="header-anchor">#</a> 授权</h2> <p>​	在SpringSecurity中，会使用默认的FilterSecurityInterceptor来进行权限校验。</p> <p>​	在FilterSecurityInterceptor中会从SecurityContextHolder获取其中的<strong>Authentication</strong>，然后获取其中的权限信息。判断当前用户是否拥有访问当前资源所需的权限。</p> <div class="custom-block tip"><p class="title"></p><ul><li>授权在认证之后</li> <li>我们可以在保存用户之前，在Authentication中封装权限</li> <li>包含用户的权限、接口的访问权限</li></ul></div><h3 id="代码授权"><a href="#代码授权" class="header-anchor">#</a> 代码授权</h3> <p><code>配置类</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//url后配置</span>
<span class="token function">hasAuthority</span><span class="token punctuation">(</span><span class="token string">&quot;权限&quot;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">&quot;ROLE_权限名&quot;</span><span class="token punctuation">)</span>
<span class="token function">hasAnyRole</span><span class="token punctuation">(</span><span class="token string">&quot;权限&quot;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>实现类</code></p> <p><img src="/assets/img/037.f5f1ada1.png" alt="image-20231114195900839"></p> <h3 id="注解授权"><a href="#注解授权" class="header-anchor">#</a> 注解授权</h3> <p>1.先在<strong>启动类</strong>或SPS<strong>配置类</strong>上添加注解</p> <p>2.在controller方法上使用相关注解</p> <p>3.在<code>实现类</code>中控制用户角色</p> <p><code>实现类</code></p> <div class="custom-block tip"><p class="title"></p><p>去除了手动控制，使用注解控制权限，将test/hello修改为需要权限【通过注解】</p></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpsBean</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserMapper</span> userMapper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token comment">//数据库查询用户认证</span>
      	<span class="token comment">//实现类配置用户权限【可以从数据库查询】</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GrantedAuthority</span><span class="token punctuation">&gt;</span></span> authorities <span class="token operator">=</span> <span class="token class-name">AuthorityUtils</span><span class="token punctuation">.</span><span class="token function">commaSeparatedStringToAuthorityList</span><span class="token punctuation">(</span><span class="token string">&quot;ROLE_vip1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//替换这里的数据为查询到的数据</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pe<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> authorities<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><code>配置类</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig2</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserDetailsService</span> uds<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        auth<span class="token punctuation">.</span><span class="token function">userDetailsService</span><span class="token punctuation">(</span>uds<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">PasswordEncoder</span> <span class="token function">passwordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        http
                <span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/test/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//哪些路径可以直接访问，无需认证</span>
                    <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//其它请求需要认证【此项放在最后】</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">//关闭csrf防护</span>
                <span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="secured"><a href="#secured" class="header-anchor">#</a> @Secured</h4> <div class="custom-block warning"><p class="title"></p><ul><li><p><code>@EnableGlobalMethodSecurity(securedEnabled = true)</code></p></li> <li><p>需要ROLE_前缀，只有拥有其中权限的用户可以访问</p></li></ul></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Secured</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;ROLE_vip1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ROLE_vip2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">helloSpringSecurity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hello SpringSecurity&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="preauthorize-常用"><a href="#preauthorize-常用" class="header-anchor">#</a> @PreAuthorize[常用]</h4> <div class="custom-block tip"><p class="title"></p><ul><li><p>@EnableGlobalMethodSecurity(prePostEnabled = true)</p></li> <li><p>进入方法前进行权限验证</p></li> <li><p>可以将用户的角色和权限【在SPS上下文】传递给方法.</p></li></ul></div><div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;update&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">//此注解支持代码配置的四种方法</span>
    <span class="token annotation punctuation">@PreAuthorize</span><span class="token punctuation">(</span><span class="token string">&quot;hasAnyRole('ROLE_admin')&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">updateSpringSecurity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;敏感操作-更新&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="postauthorize"><a href="#postauthorize" class="header-anchor">#</a> @PostAuthorize</h4> <p>也要开启注解</p> <p>在方法执行后才校验权限</p> <h4 id="prefilter"><a href="#prefilter" class="header-anchor">#</a> @PreFilter</h4> <p>也要开启注解</p> <p>在进入控制器之前鉴权</p> <h2 id="退出"><a href="#退出" class="header-anchor">#</a> 退出</h2> <p><code>配置类</code></p> <div class="custom-block tip"><p class="title"></p><ul><li>相关过滤器是LogoutFilter，需要添加到前方，否则用户为空，或者说上下文对象为空</li> <li>可以配置addLogoutHandler或logoutSuccessHandler，或者都配置来退出</li></ul></div><div class="language-java line-numbers-mode"><pre class="language-java"><code> http<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLogoutHandler</span><span class="token punctuation">(</span>customLogout<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token function">addFilterBefore</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoginCheckFilter</span><span class="token punctuation">(</span>redisTemplate<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">LogoutFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>；
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>实现类</code>addLogoutHandler</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomLogout</span> <span class="token keyword">implements</span> <span class="token class-name">LogoutHandler</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StringRedisTemplate</span> redisTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Authentication</span> auth<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> auth<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ResponseUtil</span><span class="token punctuation">.</span><span class="token function">out</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;退出成功&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="remember-me"><a href="#remember-me" class="header-anchor">#</a> Remember-Me</h2> <p>SpringSecuriry提供了记住我自动登录的功能</p> <h3 id="principle"><a href="#principle" class="header-anchor">#</a> principle</h3> <p>浏览器存储:cookie加密串</p> <p>数据库存储:加密串、用户信息串</p> <p><img src="/assets/img/038.83f64490.png" alt="image-20231114222620263"></p> <p><img src="https://i0.imgs.ovh/2023/11/14/nxKis.png" alt="image-20231114222839737"></p> <p><img src="/assets/img/039.a474afc6.png" alt="image-20231114223015034"></p> <h2 id="csrf"><a href="#csrf" class="header-anchor">#</a> CSRF</h2> <p>跨站请求伪造</p> <p>​	同一个浏览器：用户在网站A认证过【信息保存在cookie】，用户访问网站B，但是因为是同一个浏览器，它可以在网站B获取cookie,从而获取用户在网站A的相关信息，通过获取或伪造进而访问到A网站的资源。</p> <p>​	从Spring Security 4.0开始，默认情况下会启用CSRF保护，以防止CSRF 攻击应用程序，Spring Security CSRF 会针对PATCH，POST，PUT和DEETE方法进行防护。</p> <p>之前我们的代码时关闭的，存在风险</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>http<span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们不配置则自动开启，还需要再提交时添加一行就生效了</p> <p><img src="/assets/img/040.c519992f.png" alt="image-20231114224851545"></p> <p>原理是</p> <p><img src="/assets/img/041.cfe9992c.png" alt="image-20231114224959360"></p> <h2 id="补充"><a href="#补充" class="header-anchor">#</a> 补充</h2> <p>username、password、remember-me等需要字段可以再配置类中自定义，一般使用默认的即可</p></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#入门程序" class="sidebar-link reco-side-入门程序" data-v-b57cc07c>入门程序</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#准备" class="sidebar-link reco-side-准备" data-v-b57cc07c>准备</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#结果" class="sidebar-link reco-side-结果" data-v-b57cc07c>结果</a></li><li class="level-2" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#基本原理" class="sidebar-link reco-side-基本原理" data-v-b57cc07c>基本原理</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#securityconfigureradapter" class="sidebar-link reco-side-securityconfigureradapter" data-v-b57cc07c>SecurityConfigurerAdapter：</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#filter-chain的执行" class="sidebar-link reco-side-filter-chain的执行" data-v-b57cc07c>Filter Chain的执行：</a></li><li class="level-2" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#认证" class="sidebar-link reco-side-认证" data-v-b57cc07c>认证</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#认证流程" class="sidebar-link reco-side-认证流程" data-v-b57cc07c>认证流程</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#认证核心组件【必看】" class="sidebar-link reco-side-认证核心组件【必看】" data-v-b57cc07c>认证核心组件【必看】</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#用户认证过程源码【必看】" class="sidebar-link reco-side-用户认证过程源码【必看】" data-v-b57cc07c>用户认证过程源码【必看】</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#认证核心" class="sidebar-link reco-side-认证核心" data-v-b57cc07c>认证核心</a></li><li class="level-2" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#认证方式" class="sidebar-link reco-side-认证方式" data-v-b57cc07c>认证方式</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#通过配置文件" class="sidebar-link reco-side-通过配置文件" data-v-b57cc07c>通过配置文件</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#基于内存" class="sidebar-link reco-side-基于内存" data-v-b57cc07c>基于内存</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#基于数据库【重要】" class="sidebar-link reco-side-基于数据库【重要】" data-v-b57cc07c>基于数据库【重要】</a></li><li class="level-2" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#授权" class="sidebar-link reco-side-授权" data-v-b57cc07c>授权</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#代码授权" class="sidebar-link reco-side-代码授权" data-v-b57cc07c>代码授权</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#注解授权" class="sidebar-link reco-side-注解授权" data-v-b57cc07c>注解授权</a></li><li class="level-2" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#退出" class="sidebar-link reco-side-退出" data-v-b57cc07c>退出</a></li><li class="level-2" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#remember-me" class="sidebar-link reco-side-remember-me" data-v-b57cc07c>Remember-Me</a></li><li class="level-3" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#principle" class="sidebar-link reco-side-principle" data-v-b57cc07c>principle</a></li><li class="level-2" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#csrf" class="sidebar-link reco-side-csrf" data-v-b57cc07c>CSRF</a></li><li class="level-2" data-v-b57cc07c><a href="/docs/SpringSecurity-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/#补充" class="sidebar-link reco-side-补充" data-v-b57cc07c>补充</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----><canvas id="vuepress-canvas-cursor"></canvas><div data-v-2ebabc0c></div><!----><!----><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="/bgm/my_sole.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/bgm/my_soul.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/bgm/my_soul.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>my soul</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>July</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><div class="Sakura" data-v-248d85d6><canvas id="canvas_sakura" style="z-index:-1;" data-v-248d85d6></canvas></div><div></div><!----><!----><div id="goTop" class="hide-cat" data-v-bf92849a></div></div></div>
    <script src="/assets/js/app.3ca46f51.js" defer></script><script src="/assets/js/4.296817db.js" defer></script><script src="/assets/js/1.e29b6016.js" defer></script><script src="/assets/js/9.32223661.js" defer></script><script src="/assets/js/14.e948865e.js" defer></script>
  </body>
</html>
